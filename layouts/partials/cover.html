{{- with .cxt}}
{{- if (and .Params.cover.image (not $.isHidden)) }}
<figure class="entry-cover{{ with .Params.cover.class }} {{ . }}{{ end }}">
    {{- $loading := cond $.IsSingle "eager" "lazy" }}
    {{- $addLink := (and site.Params.cover.linkFullImages $.IsSingle) }}
    {{- $alt := (.Params.cover.alt | default .Params.cover.caption | plainify) }}
    {{- $imagePath := .Params.cover.image -}}

    {{- /* Link logic (as before) */}}
    {{- $customLinkURL := .Params.cover.link_url -}}
    {{- $customLinkTarget := .Params.cover.link_target | default "_self" -}}
    {{- $finalLinkURL := "" -}}
    {{- $finalLinkTarget := "" -}}
    {{- if $customLinkURL -}}
        {{- $finalLinkURL = $customLinkURL -}}
        {{- $finalLinkTarget = $customLinkTarget -}}
    {{- else if $addLink -}}
        {{- $finalLinkURL = $imagePath -}}
        {{- $finalLinkTarget = "_blank" -}}
    {{- end -}}

    {{- if $finalLinkURL -}}
        <a href="{{ $finalLinkURL | relURL }}" target="{{ $finalLinkTarget }}" rel="noopener noreferrer">
    {{- end }}

    {{/* This is the crucial part for CSS resizing */}}
    {{- if $imagePath -}}
        <img loading="{{ $loading }}"
             src="{{ $imagePath | relURL }}"
             alt="{{ $alt }}"
             class="cover-image"> {{/* Make sure this class is present */}}
    {{- else -}}
        <p>Cover image path not specified in front matter.</p>
    {{- end -}}

    {{- if $finalLinkURL -}}
        </a>
    {{- end -}}

    {{- /* Caption logic (as before) */}}
    {{- if $.IsSingle }}
        {{- with .Params.cover.caption -}}
            <figcaption>{{ . | markdownify }}</figcaption>
        {{- end }}
    {{- end }}

</figure>
{{- end }}
{{- end -}}